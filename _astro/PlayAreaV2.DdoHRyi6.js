import{l as we,e as ue,i as V,g as pe,f as ve,j as Se,a as je,s as We,h as Je,o as Ne,b as me,J as ye,_ as ke,c as Ee,d as Pe}from"./jszip.min.CBoD0JOJ.js";import{i as ge,j as b,v as n,w as fe,x as _e,l as p,o as l,n as e,F as ze,y as s,r as R,A as H,D as Ae,q as i,s as E,C as ce,k as de,p as ne}from"./branches.DiUnAkmo.js";import{p as Z}from"./props.CEJ6yodN.js";var Ce=b('<button><span class="icon svelte-f3y0ub"> </span> <span class="name"> </span></button>'),Te=b('<div class="empty svelte-f3y0ub">No files loaded</div>'),Le=b('<div class="file-explorer svelte-f3y0ub"><div class="header svelte-f3y0ub">FILES</div> <div class="list svelte-f3y0ub"><!> <!></div></div>');function Ie(K,g){_e(g,!0);const P=Z(g,"files",19,()=>[]),T=Z(g,"selectedFile",3,""),z=we();function v(r){z("select",r)}function d(r){return r.endsWith(".vy")?"ðŸ“„":r.endsWith(".toml")?"âš™ï¸":r.endsWith(".html")?"ðŸŒ":r.endsWith(".css")?"ðŸŽ¨":r.endsWith(".js")?"ðŸ“œ":"ðŸ“ƒ"}let O=ze(()=>[...P()].sort((r,h)=>r==="vyasac.toml"?-1:h==="vyasac.toml"?1:r==="context.vy"?-1:h==="context.vy"?1:r.localeCompare(h)));var c=Le(),S=p(l(c),2),j=l(S);ue(j,17,()=>e(O),pe,(r,h)=>{var F=Ce();let q;F.__click=()=>v(e(h));var M=l(F),Q=l(M,!0);s(M);var X=p(M,2),te=l(X,!0);s(X),s(F),R(D=>{q=ve(F,1,"file-item svelte-f3y0ub",null,q,{selected:e(h)===T()}),H(Q,D),H(te,e(h))},[()=>d(e(h))]),n(r,F)});var A=p(j,2);{var W=r=>{var h=Te();n(r,h)};V(A,r=>{P().length===0&&r(W)})}s(S),s(c),n(K,c),fe()}ge(["click"]);var Re=b('<div class="code-editor svelte-gz6jbe"><div class="header svelte-gz6jbe"><span class="filename svelte-gz6jbe"> </span></div> <div class="editor-container svelte-gz6jbe"><textarea spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off" class="svelte-gz6jbe"></textarea></div></div>');function De(K,g){_e(g,!0);let P=Z(g,"content",15,""),T=Z(g,"filename",3,"");var z=Re(),v=l(z),d=l(v),O=l(d,!0);s(d),s(v);var c=p(v,2),S=l(c);Ae(S),s(c),s(z),R(()=>H(O,T()||"Untitled")),Se(S,P),n(K,z),fe()}var Ue=b("<option>(No Output)</option>"),Be=b("<option> </option>"),Ve=b('<div class="file-selector svelte-17tpkbo"><select class="svelte-17tpkbo"><!></select></div>'),Ze=b('<iframe title="Preview" sandbox="allow-scripts allow-same-origin" class="svelte-17tpkbo"></iframe>'),qe=b('<div class="empty-state svelte-17tpkbo"><div class="msg svelte-17tpkbo">No content to preview</div> <div class="sub svelte-17tpkbo">Compile the workspace to see results</div></div>'),Me=b('<div class="frame-container svelte-17tpkbo"><!></div>'),Ge=b('<div class="scroll-view code-view svelte-17tpkbo"><pre class="svelte-17tpkbo"> </pre></div>'),He=b('<div class="scroll-view log-view svelte-17tpkbo"><pre class="svelte-17tpkbo"> </pre></div>'),Ke=b('<div class="preview-pane svelte-17tpkbo"><div class="header svelte-17tpkbo"><div class="tabs svelte-17tpkbo"><button>Preview</button> <button>JSON</button> <button>Logs</button></div> <!></div> <div class="content svelte-17tpkbo"><!></div></div>');function Qe(K,g){_e(g,!0);const P=we();let T=Z(g,"iframeSrc",3,""),z=Z(g,"outputFiles",19,()=>[]),v=Z(g,"debugJson",3,""),d=Z(g,"logs",3,""),O=Z(g,"selectedOutputFile",3,""),c=E("preview");function S(w){const m=w.target;P("selectFile",m.value)}var j=Ke(),A=l(j),W=l(A),r=l(W);let h;r.__click=()=>i(c,"preview");var F=p(r,2);let q;F.__click=()=>i(c,"debug");var M=p(F,2);let Q;M.__click=()=>i(c,"logs"),s(W);var X=p(W,2);{var te=w=>{var m=Ve(),_=l(m);_.__change=S;var U=l(_);{var L=x=>{var J=Ue();J.value=J.__value="",n(x,J)},u=x=>{var J=ce(),Y=de(J);ue(Y,17,z,pe,(G,I)=>{var B=Be(),le=l(B,!0);s(B);var re={};R(be=>{H(le,be),re!==(re=e(I))&&(B.value=(B.__value=e(I))??"")},[()=>e(I).replace("output/","")]),n(G,B)}),n(x,J)};V(U,x=>{z().length===0?x(L):x(u,!1)})}s(_);var y;je(_),s(m),R(()=>{_.disabled=z().length===0,y!==(y=O())&&(_.value=(_.__value=O())??"",We(_,O()))}),n(w,m)};V(X,w=>{e(c)==="preview"&&w(te)})}s(A);var D=p(A,2),ie=l(D);{var ae=w=>{var m=Me(),_=l(m);{var U=u=>{var y=Ze();R(()=>Je(y,"srcdoc",T())),n(u,y)},L=u=>{var y=qe();n(u,y)};V(_,u=>{T()?u(U):u(L,!1)})}s(m),n(w,m)},se=w=>{var m=ce(),_=de(m);{var U=u=>{var y=Ge(),x=l(y),J=l(x,!0);s(x),s(y),R(()=>H(J,v()||"No debug data available")),n(u,y)},L=u=>{var y=ce(),x=de(y);{var J=Y=>{var G=He(),I=l(G),B=l(I,!0);s(I),s(G),R(()=>H(B,d())),n(Y,G)};V(x,Y=>{e(c)==="logs"&&Y(J)},!0)}n(u,y)};V(_,u=>{e(c)==="debug"?u(U):u(L,!1)},!0)}n(w,m)};V(ie,w=>{e(c)==="preview"?w(ae):w(se,!1)})}s(D),s(j),R(()=>{h=ve(r,1,"tab svelte-17tpkbo",null,h,{active:e(c)==="preview"}),q=ve(F,1,"tab svelte-17tpkbo",null,q,{active:e(c)==="debug"}),Q=ve(M,1,"tab svelte-17tpkbo",null,Q,{active:e(c)==="logs"})}),n(K,j),fe()}ge(["click","change"]);var Xe=b("<option> </option>"),Ye=b("<option> </option>"),$e=b('<div class="empty-editor svelte-gz65b9">Select a file to edit</div>'),et=b('<div class="ide-container svelte-gz65b9"><header class="svelte-gz65b9"><div class="brand svelte-gz65b9"><strong>Vyasa</strong> Play</div> <div class="controls svelte-gz65b9"><div class="control-group svelte-gz65b9"><span class="label svelte-gz65b9">Workspace</span> <select class="svelte-gz65b9"></select></div> <div class="control-group svelte-gz65b9"><span class="label svelte-gz65b9">Template</span> <select class="svelte-gz65b9"><option>AST (Built-in)</option><!></select></div> <button class="action-btn svelte-gz65b9">â–¶ Run</button> <label class="upload-btn svelte-gz65b9">Import Zip <input type="file" accept=".zip" class="svelte-gz65b9"/></label></div></header> <div class="workspace svelte-gz65b9"><div class="pane sidebar svelte-gz65b9"><!></div> <div class="pane editor svelte-gz65b9"><!></div> <div class="pane preview svelte-gz65b9"><!></div></div></div>');function lt(K,g){_e(g,!0);let P=E(""),T=E(""),z=E(""),v=E(ne({})),d=E(""),O=E(ne([])),c=E(""),S=E(`System Logs:
`),j=E(ne([])),A=E(""),W=E(ne([])),r=E("");function h(...t){console.log(...t),i(S,e(S)+(t.map(a=>typeof a=="object"?JSON.stringify(a):String(a)).join(" ")+`
`))}function F(...t){console.error(...t),i(S,e(S)+("[ERROR] "+t.map(a=>typeof a=="object"?JSON.stringify(a):String(a)).join(" ")+`
`))}function q(){const t="/vyasa-docs";return t.endsWith("/")?t:t+"/"}async function M(){try{const t=q(),a=await fetch(`${t}samples/index.json?t=${Date.now()}`);if(a.ok){const o=await a.json();o.length>0&&(typeof o[0]=="string"?i(j,o.map(f=>({id:f,name:f,file:`${f}.zip`,hash:""})),!0):i(j,o,!0),e(j).length>0&&(i(A,e(j)[0].id,!0),await Q(e(A))))}}catch(t){F("Failed to fetch workspaces:",t)}}async function Q(t){try{const a=e(j).find(ee=>ee.id===t);if(!a)return;h(`Loading workspace: ${a.name}`),i(O,[],!0),i(P,""),i(z,""),i(v,{},!0),i(d,"");const f=`${q()}samples/${a.file}`+(a.hash?`?v=${a.hash}`:""),N=await fetch(f);if(!N.ok)throw new Error(`Failed to fetch ${a.file}`);const k=await N.blob(),C=await ye.loadAsync(k),oe={};for(const ee of Object.keys(C.files))if(!C.files[ee].dir){const Oe=ee.startsWith("/")?ee.slice(1):ee;oe[Oe]=await C.files[ee].async("string")}i(v,oe,!0);const $=Object.keys(e(v));$.includes("content/1.vy")?i(d,"content/1.vy"):$.includes("context.vy")?i(d,"context.vy"):$.length>0&&i(d,$[0],!0),X(),D()}catch(a){F("Error loading workspace:",a),i(T,a.toString(),!0)}}function X(){const t=new Set;t.add("ast.html");for(const a of Object.keys(e(v)))if(a.startsWith("templates/")&&a.endsWith(".html")){const o=a.split("/").pop();o&&t.add(o)}if(i(W,Array.from(t).sort(),!0),!e(W).includes(e(r)))if(e(W).includes("default.html"))i(r,"default.html");else{const a=e(W).find(o=>o!=="ast.html");i(r,a||(e(W).length>0?e(W)[0]:""),!0)}}async function te(t){const o=t.target.files?.[0];if(!(!o||!o.name.endsWith(".zip")))try{const f=await ye.loadAsync(o),N={};for(const k of Object.keys(f.files))if(!f.files[k].dir){const C=k.startsWith("/")?k.slice(1):k;N[C]=await f.files[k].async("string")}i(v,N,!0),Object.keys(e(v)).length>0&&i(d,Object.keys(e(v))[0],!0),X(),D()}catch(f){F("Upload failed:",f)}}async function D(){try{i(T,""),h("Compiling..."),await ke();try{Ee()}catch{}const t=JSON.parse(JSON.stringify(e(v))),a=e(r)!=="default.html"?e(r):void 0,o=Pe(t,a),f=JSON.parse(o);i(P,JSON.stringify(f,null,2),!0),i(O,Object.keys(f).filter(k=>k.startsWith("output/")).sort(),!0);const N=e(O).find(k=>k.endsWith(".html"))||e(O)[0];N?ie(N):i(z,"")}catch(t){F("Compilation Error:",t),i(T,t.toString(),!0)}}function ie(t){i(c,t,!0);try{const a=JSON.parse(e(P));a&&a[t]&&i(z,a[t],!0)}catch{}}Ne(async()=>{await ke(),await M()});var ae=et(),se=l(ae),w=p(l(se),2),m=l(w),_=p(l(m),2);_.__change=()=>Q(e(A)),ue(_,21,()=>e(j),pe,(t,a)=>{var o=Xe(),f=l(o,!0);s(o);var N={};R(()=>{H(f,e(a).name),N!==(N=e(a).id)&&(o.value=(o.__value=e(a).id)??"")}),n(t,o)}),s(_),s(m);var U=p(m,2),L=p(l(U),2);L.__change=D;var u=l(L);u.value=u.__value="ast.html";var y=p(u);ue(y,17,()=>e(W),pe,(t,a)=>{var o=ce(),f=de(o);{var N=k=>{var C=Ye(),oe=l(C,!0);s(C);var $={};R(()=>{H(oe,e(a)),$!==($=e(a))&&(C.value=(C.__value=e(a))??"")}),n(k,C)};V(f,k=>{e(a)!=="ast.html"&&k(N)})}n(t,o)}),s(L),s(U);var x=p(U,2);x.__click=D;var J=p(x,2),Y=p(l(J));Y.__change=te,s(J),s(w),s(se);var G=p(se,2),I=l(G),B=l(I);{let t=ze(()=>Object.keys(e(v)));Ie(B,{get files(){return e(t)},get selectedFile(){return e(d)},$$events:{select:a=>i(d,a.detail,!0)}})}s(I);var le=p(I,2),re=l(le);{var be=t=>{De(t,{get filename(){return e(d)},get content(){return e(v)[e(d)]},set content(a){e(v)[e(d)]=a}})},Fe=t=>{var a=$e();n(t,a)};V(re,t=>{e(d)&&e(v)[e(d)]!==void 0?t(be):t(Fe,!1)})}s(le);var he=p(le,2),xe=l(he);Qe(xe,{get iframeSrc(){return e(z)},get outputFiles(){return e(O)},get debugJson(){return e(P)},get logs(){return e(S)},get selectedOutputFile(){return e(c)},$$events:{selectFile:t=>ie(t.detail)}}),s(he),s(G),s(ae),me(_,()=>e(A),t=>i(A,t)),me(L,()=>e(r),t=>i(r,t)),n(K,ae),fe()}ge(["change","click"]);export{lt as default};
