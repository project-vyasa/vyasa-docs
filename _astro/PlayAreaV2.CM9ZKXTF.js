import{l as we,e as Y,i as ee,g as te,f as je,j as xe,o as Se,b as ve,J as de,_ as ue,c as Fe,d as Oe}from"./jszip.min.BoRdOq_a.js";import{i as fe,j as F,v as S,w as se,x as ae,l as u,o as n,n as e,F as pe,y as r,r as B,A as T,D as We,s as g,p as U,q as a,C as Je,k as Ee}from"./branches.CeVhODSW.js";import{p as V,P as Ne}from"./PreviewPane.DD6Amh6R.js";var Ae=F('<button><span class="icon svelte-f3y0ub"> </span> <span class="name"> </span></button>'),Pe=F('<div class="empty svelte-f3y0ub">No files loaded</div>'),Ce=F('<div class="file-explorer svelte-f3y0ub"><div class="header svelte-f3y0ub">FILES</div> <div class="list svelte-f3y0ub"><!> <!></div></div>');function $e(A,y){ae(y,!0);const k=V(y,"files",19,()=>[]),O=V(y,"selectedFile",3,""),_=we();function o(i){_("select",i)}function v(i){return i.endsWith(".vy")?"ðŸ“„":i.endsWith(".toml")?"âš™ï¸":i.endsWith(".html")?"ðŸŒ":i.endsWith(".css")?"ðŸŽ¨":i.endsWith(".js")?"ðŸ“œ":"ðŸ“ƒ"}let z=pe(()=>[...k()].sort((i,f)=>i==="vyasac.toml"?-1:f==="vyasac.toml"?1:i==="context.vy"?-1:f==="context.vy"?1:i.localeCompare(f)));var w=Ce(),b=u(n(w),2),j=n(b);Y(j,17,()=>e(z),te,(i,f)=>{var m=Ae();let P;m.__click=()=>o(e(f));var C=n(m),I=n(C,!0);r(C);var $=u(C,2),Z=n($,!0);r($),r(m),B(N=>{P=je(m,1,"file-item svelte-f3y0ub",null,P,{selected:e(f)===O()}),T(I,N),T(Z,e(f))},[()=>v(e(f))]),S(i,m)});var W=u(j,2);{var x=i=>{var f=Pe();S(i,f)};ee(W,i=>{k().length===0&&i(x)})}r(b),r(w),S(A,w),se()}fe(["click"]);var Te=F('<div class="code-editor svelte-gz6jbe"><div class="header svelte-gz6jbe"><span class="filename svelte-gz6jbe"> </span></div> <div class="editor-container svelte-gz6jbe"><textarea spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off" class="svelte-gz6jbe"></textarea></div></div>');function Ie(A,y){ae(y,!0);let k=V(y,"content",15,""),O=V(y,"filename",3,"");var _=Te(),o=n(_),v=n(o),z=n(v,!0);r(v),r(o);var w=u(o,2),b=n(w);We(b),r(w),r(_),B(()=>T(z,O()||"Untitled")),xe(b,k),S(A,_),se()}var Le=F("<option> </option>"),Re=F("<option> </option>"),De=F('<div class="empty-editor svelte-gz65b9">Select a file to edit</div>'),Ue=F('<div class="ide-container svelte-gz65b9"><header class="svelte-gz65b9"><div class="brand svelte-gz65b9"><strong>Vyasa</strong> Play</div> <div class="controls svelte-gz65b9"><div class="control-group svelte-gz65b9"><span class="label svelte-gz65b9">Workspace</span> <select class="svelte-gz65b9"></select></div> <div class="control-group svelte-gz65b9"><span class="label svelte-gz65b9">Template</span> <select class="svelte-gz65b9"><option>AST (Built-in)</option><!></select></div> <button class="action-btn svelte-gz65b9">â–¶ Run</button> <label class="upload-btn svelte-gz65b9">Import Zip <input type="file" accept=".zip" class="svelte-gz65b9"/></label></div></header> <div class="workspace svelte-gz65b9"><div class="pane sidebar svelte-gz65b9"><!></div> <div class="pane editor svelte-gz65b9"><!></div> <div class="pane preview svelte-gz65b9"><!></div></div></div>');function qe(A,y){ae(y,!0);let k=g(""),O=g(""),_=g(""),o=g(U({})),v=g(""),z=g(U([])),w=g(""),b=g(`System Logs:
`),j=g(U([])),W=g(""),x=g(U([])),i=g("");function f(...t){console.log(...t),a(b,e(b)+(t.map(s=>typeof s=="object"?JSON.stringify(s):String(s)).join(" ")+`
`))}function m(...t){console.error(...t),a(b,e(b)+("[ERROR] "+t.map(s=>typeof s=="object"?JSON.stringify(s):String(s)).join(" ")+`
`))}function P(){const t="/vyasa-docs";return t.endsWith("/")?t:t+"/"}async function C(){try{const t=P(),s=await fetch(`${t}samples/index.json?t=${Date.now()}`);if(s.ok){const l=await s.json();l.length>0&&(typeof l[0]=="string"?a(j,l.map(c=>({id:c,name:c,file:`${c}.zip`,hash:""})),!0):a(j,l,!0),e(j).length>0&&(a(W,e(j)[0].id,!0),await I(e(W))))}}catch(t){m("Failed to fetch workspaces:",t)}}async function I(t){try{const s=e(j).find(E=>E.id===t);if(!s)return;f(`Loading workspace: ${s.name}`),a(z,[],!0),a(k,""),a(_,""),a(o,{},!0),a(v,"");const c=`${P()}samples/${s.file}`+(s.hash?`?v=${s.hash}`:""),p=await fetch(c);if(!p.ok)throw new Error(`Failed to fetch ${s.file}`);const d=await p.blob(),h=await de.loadAsync(d),D={};for(const E of Object.keys(h.files))if(!h.files[E].dir){const ze=E.startsWith("/")?E.slice(1):E;D[ze]=await h.files[E].async("string")}a(o,D,!0);const J=Object.keys(e(o));J.includes("content/1.vy")?a(v,"content/1.vy"):J.includes("context.vy")?a(v,"context.vy"):J.length>0&&a(v,J[0],!0),$(),N()}catch(s){m("Error loading workspace:",s),a(O,s.toString(),!0)}}function $(){const t=new Set;t.add("ast.html");for(const s of Object.keys(e(o)))if(s.startsWith("templates/")&&s.endsWith(".html")){const l=s.split("/").pop();l&&t.add(l)}if(a(x,Array.from(t).sort(),!0),!e(x).includes(e(i)))if(e(x).includes("default.html"))a(i,"default.html");else{const s=e(x).find(l=>l!=="ast.html");a(i,s||(e(x).length>0?e(x)[0]:""),!0)}}async function Z(t){const l=t.target.files?.[0];if(!(!l||!l.name.endsWith(".zip")))try{const c=await de.loadAsync(l),p={};for(const d of Object.keys(c.files))if(!c.files[d].dir){const h=d.startsWith("/")?d.slice(1):d;p[h]=await c.files[d].async("string")}a(o,p,!0),Object.keys(e(o)).length>0&&a(v,Object.keys(e(o))[0],!0),$(),N()}catch(c){m("Upload failed:",c)}}async function N(){try{a(O,""),f("Compiling..."),await ue();try{Fe()}catch{}const t=JSON.parse(JSON.stringify(e(o))),s=e(i)!=="default.html"?e(i):void 0,l=Oe(t,s),c=JSON.parse(l);a(k,JSON.stringify(c,null,2),!0),a(z,Object.keys(c).filter(d=>d.startsWith("output/")).sort(),!0);const p=e(z).find(d=>d.endsWith(".html"))||e(z)[0];p?ie(p):a(_,"")}catch(t){m("Compilation Error:",t),a(O,t.toString(),!0)}}function ie(t){a(w,t,!0);try{const s=JSON.parse(e(k));s&&s[t]&&a(_,s[t],!0)}catch{}}Se(async()=>{await ue(),await C()});var q=Ue(),M=n(q),le=u(n(M),2),G=n(le),L=u(n(G),2);L.__change=()=>I(e(W)),Y(L,21,()=>e(j),te,(t,s)=>{var l=Le(),c=n(l,!0);r(l);var p={};B(()=>{T(c,e(s).name),p!==(p=e(s).id)&&(l.value=(l.__value=e(s).id)??"")}),S(t,l)}),r(L),r(G);var H=u(G,2),R=u(n(H),2);R.__change=N;var K=n(R);K.value=K.__value="ast.html";var ge=u(K);Y(ge,17,()=>e(x),te,(t,s)=>{var l=Je(),c=Ee(l);{var p=d=>{var h=Re(),D=n(h,!0);r(h);var J={};B(()=>{T(D,e(s)),J!==(J=e(s))&&(h.value=(h.__value=e(s))??"")}),S(d,h)};ee(c,d=>{e(s)!=="ast.html"&&d(p)})}S(t,l)}),r(R),r(H);var re=u(H,2);re.__click=N;var ne=u(re,2),be=u(n(ne));be.__change=Z,r(ne),r(le),r(M);var oe=u(M,2),Q=n(oe),he=n(Q);{let t=pe(()=>Object.keys(e(o)));$e(he,{get files(){return e(t)},get selectedFile(){return e(v)},$$events:{select:s=>a(v,s.detail,!0)}})}r(Q);var X=u(Q,2),_e=n(X);{var me=t=>{Ie(t,{get filename(){return e(v)},get content(){return e(o)[e(v)]},set content(s){e(o)[e(v)]=s}})},ye=t=>{var s=De();S(t,s)};ee(_e,t=>{e(v)&&e(o)[e(v)]!==void 0?t(me):t(ye,!1)})}r(X);var ce=u(X,2),ke=n(ce);Ne(ke,{get iframeSrc(){return e(_)},get outputFiles(){return e(z)},get debugJson(){return e(k)},get logs(){return e(b)},get selectedOutputFile(){return e(w)},$$events:{selectFile:t=>ie(t.detail)}}),r(ce),r(oe),r(q),ve(L,()=>e(W),t=>a(W,t)),ve(R,()=>e(i),t=>a(i,t)),S(A,q),se()}fe(["change","click"]);export{qe as default};
