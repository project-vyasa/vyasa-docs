import{o as Ve,e as M,i as W,a as qe,b as we,J as ke,_ as xe,c as Ge,d as Ze,s as He,f as B,g as U,h as Se,j as Ke,k as Qe}from"./jszip.min.D1D6RYVc.js";import{i as Xe,s as b,p as V,j as m,k as C,l as d,n as a,o as n,q as l,r as k,v as u,w as Ye,x as $e,y as o,z as et,A as J,C as q,D as Oe,F as tt,G as at}from"./branches.DiUnAkmo.js";var st=m("<option> </option>"),lt=m("<option> </option>"),it=m('<div class="error svelte-1epbfvm"> </div>'),rt=m('<div><div class="file-header svelte-1epbfvm"><label class="svelte-1epbfvm"> </label> <button class="icon-btn svelte-1epbfvm"> </button></div> <textarea rows="6" class="svelte-1epbfvm"></textarea></div>'),vt=m("<option>(No output)</option>"),ot=m("<option> </option>"),nt=m('<iframe title="Preview" sandbox="allow-scripts allow-same-origin" class="svelte-1epbfvm"></iframe>'),ct=m('<div class="empty-state svelte-1epbfvm">No content to preview</div>'),pt=m('<div class="preview-frame svelte-1epbfvm"><!></div>'),ft=m('<div class="debug-view svelte-1epbfvm"><pre class="svelte-1epbfvm"> </pre></div>'),dt=m('<div class="logs-view svelte-1epbfvm"><textarea readonly="" class="svelte-1epbfvm"></textarea></div>'),ut=m('<div class="playarea-container svelte-1epbfvm"><header class="svelte-1epbfvm"><div class="brand-group svelte-1epbfvm"><h1 class="svelte-1epbfvm">Vyasa Playarea</h1> <div class="selector svelte-1epbfvm"><span class="label svelte-1epbfvm">Workspace:</span> <select class="svelte-1epbfvm"></select></div> <div class="selector svelte-1epbfvm"><span class="label svelte-1epbfvm">Template:</span> <select class="svelte-1epbfvm"><option>AST (Built-in)</option><!></select></div></div> <div class="actions svelte-1epbfvm"><label class="upload-btn svelte-1epbfvm">Upload (.zip) <input type="file" accept=".zip" class="svelte-1epbfvm"/></label> <button class="primary svelte-1epbfvm">Recompile</button></div></header> <div class="container svelte-1epbfvm"><div class="column editor svelte-1epbfvm"><h2 class="svelte-1epbfvm">Input Files</h2> <!> <div class="file-list svelte-1epbfvm"></div></div> <div class="column output svelte-1epbfvm"><div class="tabs-header svelte-1epbfvm"><div class="generated-files svelte-1epbfvm"><span class="label svelte-1epbfvm">Files:</span> <select class="svelte-1epbfvm"><!></select></div> <div class="tabs svelte-1epbfvm"><button>Preview</button> <button>Debug JSON</button> <button>System Logs</button></div></div> <div class="tab-content svelte-1epbfvm"><!></div></div></div></div> ```',1);function mt(je,ze){$e(ze,!0),console.log("Initializing PlayArea.svelte");let j=b(""),g=b(""),x=b(""),y=b(V([])),E=b(`System Logs:
`),w=b(V({})),A=b(V([])),T=b(""),z=b(V([])),S=b(""),h=b("preview"),P=b(null);function Fe(e){a(P)===e?l(P,null):l(P,e,!0)}function G(...e){console.log(...e),l(E,a(E)+(e.map(t=>typeof t=="object"?JSON.stringify(t):String(t)).join(" ")+`
`))}function R(...e){console.error(...e),l(E,a(E)+("[ERROR] "+e.map(t=>typeof t=="object"?JSON.stringify(t):String(t)).join(" ")+`
`))}function se(){const e="/vyasa-docs";return e.endsWith("/")?e:e+"/"}async function Ne(){try{const e=se(),t=await fetch(`${e}samples/index.json?t=${Date.now()}`);if(t.ok){const s=await t.json();s.length>0&&(typeof s[0]=="string"?l(A,s.map(r=>({id:r,name:r,file:`${r}.zip`,hash:""})),!0):l(A,s,!0),a(A).length>0&&(l(T,a(A)[0].id,!0),await le(a(T))))}}catch(e){R("Failed to fetch workspace list:",e)}}async function le(e){try{const t=a(A).find(f=>f.id===e);if(!t)return;G(`Loading workspace: ${t.name}`),l(y,[],!0),l(j,""),l(x,""),l(w,{},!0),l(g,"");const r=`${se()}samples/${t.file}`+(t.hash?`?v=${t.hash}`:""),c=await fetch(r);if(!c.ok)throw new Error(`Failed to fetch ${t.file}`);const i=await c.blob(),v=await ke.loadAsync(i),p={};for(const f of Object.keys(v.files)){const _=v.files[f];if(!_.dir){const F=await _.async("string"),N=f.startsWith("/")?f.slice(1):f;p[N]=F}}l(w,p,!0),ie(),L()}catch(t){R("Error loading workspace:",t),l(g,t.toString(),!0)}}function ie(){const e=new Set;e.add("ast.html");for(const t of Object.keys(a(w)))if(t.startsWith("templates/")&&t.endsWith(".html")){const s=t.split("/").pop();s&&e.add(s)}if(l(z,Array.from(e).sort(),!0),!a(z).includes(a(S)))if(a(z).includes("default.html"))l(S,"default.html");else{const t=a(z).find(s=>s!=="ast.html");l(S,t||(a(z).length>0?a(z)[0]:""),!0)}}async function We(e){const s=e.target.files?.[0];if(s){if(!s.name.endsWith(".zip")){l(g,"Please select a .zip file");return}try{const r=await ke.loadAsync(s),c={},i=Object.keys(r.files);for(const v of i){const p=r.files[v];if(!p.dir){const f=await p.async("string"),_=v.startsWith("/")?v.slice(1):v;c[_]=f}}l(w,c,!0),l(g,""),ie(),L()}catch(r){R(r),l(g,"Failed to load zip: "+r.message)}}}async function L(){try{l(g,""),G("Compiling workspace...",{files:Object.keys(a(w)),template:a(S)}),await xe();try{Ge()}catch{}const e=JSON.parse(JSON.stringify(a(w)));let t;a(S)!=="default"&&(t=a(S));const s=Ze(e,t),r=JSON.parse(s);G("Compilation result keys:",Object.keys(r)),l(j,JSON.stringify(r,null,2),!0),l(y,Object.keys(r).filter(i=>i.startsWith("output/")).sort(),!0);const c=a(y).find(i=>i.endsWith(".html"))||a(y)[0];c?(l(x,r[c],!0),l(h,"preview")):l(x,"")}catch(e){R("Compilation Error:",e),l(g,e.toString(),!0),l(j,""),l(y,[],!0)}}function Je(e){if(typeof a(j)=="string")try{const t=JSON.parse(a(j));t&&t[e]&&(l(x,t[e],!0),l(h,"preview"))}catch{}}function Ae(e,t){try{return JSON.parse(a(j))[e]===t}catch{return!1}}Ve(async()=>{await xe(),await Ne()});var re=ut(),ve=C(re),Z=n(ve),H=n(Z),K=d(n(H),2),D=d(n(K),2);D.__change=()=>le(a(T)),M(D,21,()=>a(A),U,(e,t)=>{var s=st(),r=n(s,!0);o(s);var c={};k(()=>{J(r,a(t).name),c!==(c=a(t).id)&&(s.value=(s.__value=a(t).id)??"")}),u(e,s)}),o(D),o(K);var oe=d(K,2),I=d(n(oe),2);I.__change=L;var Q=n(I);Q.value=Q.__value="ast.html";var Pe=d(Q);M(Pe,17,()=>a(z),U,(e,t)=>{var s=q(),r=C(s);{var c=i=>{var v=lt(),p=n(v,!0);o(v);var f={};k(()=>{J(p,a(t)),f!==(f=a(t))&&(v.value=(v.__value=a(t))??"")}),u(i,v)};W(r,i=>{a(t)!=="default"&&a(t)!=="ast.html"&&i(c)})}u(e,s)}),o(I),o(oe),o(H);var ne=d(H,2),X=n(ne),Ee=d(n(X));Ee.__change=We,o(X);var Te=d(X,2);Te.__click=L,o(ne),o(Z);var ce=d(Z,2),Y=n(ce),pe=d(n(Y),2);{var Ce=e=>{var t=it(),s=n(t,!0);o(t),k(()=>J(s,a(g))),u(e,t)};W(pe,e=>{a(g)&&e(Ce)})}var fe=d(pe,2);M(fe,21,()=>Object.entries(a(w)),U,(e,t)=>{var s=tt(()=>at(a(t),2));let r=()=>a(s)[0];var c=rt();let i;var v=n(c),p=n(v),f=n(p,!0);o(p);var _=d(p,2);_.__click=()=>Fe(r());var F=n(_,!0);o(_),o(v);var N=d(v,2);Oe(N),o(c),k(()=>{i=B(c,1,"file-entry svelte-1epbfvm",null,i,{maximized:a(P)===r()}),J(f,r()),Se(_,"title",a(P)===r()?"Restore":"Maximize"),J(F,a(P)===r()?"↙":"⤢")}),Ke(N,()=>a(w)[r()],Ue=>a(w)[r()]=Ue),u(e,c)}),o(fe),o(Y);var de=d(Y,2),$=n(de),ee=n($),O=d(n(ee),2);O.__change=e=>Je(e.currentTarget.value);var Re=n(O);{var Le=e=>{var t=vt();t.value=t.__value="",u(e,t)},De=e=>{var t=q(),s=C(t);M(s,17,()=>a(y),U,(r,c)=>{var i=ot(),v=n(i,!0);o(i);var p={};k(f=>{J(v,f),p!==(p=a(c))&&(i.value=(i.__value=a(c))??"")},[()=>a(c).replace("output/","")]),u(r,i)}),u(e,t)};W(Re,e=>{a(y).length===0?e(Le):e(De,!1)})}o(O);var ue;qe(O),o(ee);var _e=d(ee,2),te=n(_e);let be;te.__click=()=>l(h,"preview");var ae=d(te,2);let me;ae.__click=()=>l(h,"debug");var he=d(ae,2);let ge;he.__click=()=>l(h,"logs"),o(_e),o($);var ye=d($,2),Ie=n(ye);{var Me=e=>{var t=pt(),s=n(t);{var r=i=>{var v=nt();k(()=>Se(v,"srcdoc",a(x))),u(i,v)},c=i=>{var v=ct();u(i,v)};W(s,i=>{a(x)?i(r):i(c,!1)})}o(t),u(e,t)},Be=e=>{var t=q(),s=C(t);{var r=i=>{var v=ft(),p=n(v),f=n(p,!0);o(p),o(v),k(()=>J(f,a(j)||"No debug data")),u(i,v)},c=i=>{var v=q(),p=C(v);{var f=_=>{var F=dt(),N=n(F);Oe(N),o(F),k(()=>Qe(N,a(E))),u(_,F)};W(p,_=>{a(h)==="logs"&&_(f)},!0)}u(i,v)};W(s,i=>{a(h)==="debug"?i(r):i(c,!1)},!0)}u(e,t)};W(Ie,e=>{a(h)==="preview"?e(Me):e(Be,!1)})}o(ye),o(de),o(ce),o(ve),et(),k(e=>{O.disabled=a(y).length===0,ue!==(ue=e)&&(O.value=(O.__value=e)??"",He(O,e)),be=B(te,1,"tab svelte-1epbfvm",null,be,{active:a(h)==="preview"}),me=B(ae,1,"tab svelte-1epbfvm",null,me,{active:a(h)==="debug"}),ge=B(he,1,"tab svelte-1epbfvm",null,ge,{active:a(h)==="logs"})},[()=>a(x)&&a(y).find(e=>Ae(e,a(x)))||""]),we(D,()=>a(T),e=>l(T,e)),we(I,()=>a(S),e=>l(S,e)),u(je,re),Ye()}Xe(["change","click"]);export{mt as default};
